name: Job completed
source: marketplace
type: raw_sql
rawSql: |
  SELECT
    user_id,
    event_id,
    DATEADD(DAY, - number_7, CURRENT_TIMESTAMP()) AS TIMESTAMP,
    boolean_52 AS logged_in,
    -- Generate a random whole number between 25 and 200 for FLEA
    CAST(ROUND(((number_100 - 1) / 99.0) * (200 - 25) + 25) AS INT) AS FLEA,
    user_id AS SKU,
    -- Assign job categories
    CASE
      WHEN number_10 = 0 THEN 'Design'
      WHEN number_10 = 1 THEN 'Design'
      WHEN number_10 = 2 THEN 'Content writing'
      WHEN number_10 = 3 THEN 'Content writing'
      WHEN number_10 = 4 THEN 'Design'
      WHEN number_10 = 5 THEN 'SEO specialist'
      WHEN number_10 = 6 THEN 'Marketing consultant'
      WHEN number_10 = 7 THEN 'Influencer marketing'
      WHEN number_10 = 8 THEN 'Influencer marketing'
      WHEN number_10 = 9 THEN 'Video editing'
      WHEN number_10 = 10 THEN 'Translation services'
      ELSE NULL
    END AS Job_category,
    -- Assign operating systems
    CASE
      WHEN number_7 = 0 THEN 'Android'
      WHEN number_7 = 1 THEN 'Android'
      WHEN number_7 = 2 THEN 'Android'
      WHEN number_7 = 3 THEN 'iOS'
      WHEN number_7 = 4 THEN 'iOS'
      WHEN number_7 = 5 THEN 'iOS'
      WHEN number_7 = 6 THEN 'iOS'
      WHEN number_7 = 7 THEN 'iOS'
      ELSE NULL
    END AS OS,
    -- Assign device types
    CASE
      WHEN number_7 = 0 THEN 'Tablet'
      WHEN number_7 = 1 THEN 'Tablet'
      WHEN number_7 = 2 THEN 'Tablet'
      WHEN number_7 = 3 THEN 'Phone'
      WHEN number_7 = 4 THEN 'Phone'
      WHEN number_7 = 5 THEN 'Phone'
      WHEN number_7 = 6 THEN 'Phone'
      WHEN number_7 = 7 THEN 'Phone'
      ELSE NULL
    END AS DEVICE_TYPE,
    -- Assign sources
    CASE
      WHEN number_7 = 0 THEN 'Facebook'
      WHEN number_7 = 1 THEN 'Facebook'
      WHEN number_7 = 2 THEN 'Google'
      WHEN number_7 = 3 THEN 'Instagram'
      WHEN number_7 = 4 THEN 'TikTok'
      WHEN number_7 = 5 THEN 'TikTok'
      WHEN number_7 = 6 THEN 'Facebook'
      WHEN number_7 = 7 THEN 'Facebook'
      ELSE NULL
    END AS SOURCE
  FROM
    PUBLIC.events;
eventTimestampColumn: TIMESTAMP
