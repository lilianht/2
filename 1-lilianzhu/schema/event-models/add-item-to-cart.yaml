name: Add item to cart
source: e-commerce
type: raw_sql
rawSql: |
  SELECT
    USER_ID,
    EVENT_ID,
    DATEADD(DAY, -NUMBER_7, CURRENT_TIMESTAMP()) AS TIMESTAMP,
    BOOLEAN_52 AS LOGGED_IN,
    USER_ID AS SKU,
    -- Assign OS based on NUMBER_7
    CASE
      WHEN NUMBER_7 = 0 THEN 'Android'
      WHEN NUMBER_7 = 1 THEN 'Android'
      WHEN NUMBER_7 = 2 THEN 'Android'
      WHEN NUMBER_7 = 3 THEN 'iOS'
      WHEN NUMBER_7 = 4 THEN 'iOS'
      WHEN NUMBER_7 = 5 THEN 'iOS'
      WHEN NUMBER_7 = 6 THEN 'iOS'
      WHEN NUMBER_7 = 7 THEN 'iOS'
      ELSE NULL
    END AS OS,
    -- Assign device type based on NUMBER_7
    CASE
      WHEN NUMBER_7 = 0 THEN 'Tablet'
      WHEN NUMBER_7 = 1 THEN 'Tablet'
      WHEN NUMBER_7 = 2 THEN 'Tablet'
      WHEN NUMBER_7 = 3 THEN 'Phone'
      WHEN NUMBER_7 = 4 THEN 'Phone'
      WHEN NUMBER_7 = 5 THEN 'Phone'
      WHEN NUMBER_7 = 6 THEN 'Phone'
      WHEN NUMBER_7 = 7 THEN 'Phone'
      ELSE NULL
    END AS DEVICE_TYPE,
    -- Assign source based on NUMBER_7
    CASE
      WHEN NUMBER_7 = 0 THEN 'Facebook'
      WHEN NUMBER_7 = 1 THEN 'Facebook'
      WHEN NUMBER_7 = 2 THEN 'Google'
      WHEN NUMBER_7 = 3 THEN 'Instagram'
      WHEN NUMBER_7 = 4 THEN 'TikTok'
      WHEN NUMBER_7 = 5 THEN 'TikTok'
      WHEN NUMBER_7 = 6 THEN 'Facebook'
      WHEN NUMBER_7 = 7 THEN 'Facebook'
      ELSE NULL
    END AS SOURCE,
    -- Generate cart total based on NUMBER_1000
    50 + MOD(ABS(NUMBER_1000), 351) AS CART_TOTAL -- Random value between $50 and $400
  FROM
    PUBLIC.EVENTS;
eventTimestampColumn: TIMESTAMP
